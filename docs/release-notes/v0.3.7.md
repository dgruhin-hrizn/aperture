# Aperture v0.3.7 Release Notes

Hey everyone! üëã

This is a quick patch release that fixes some annoying issues with MDBList Top Picks sorting and API error alerts. Here's what's new:

---

## üîß MDBList Top Picks Sorting Fix

**The Problem:** When you selected a sort option like "IMDb Popular" for your Top Picks, the results were completely wrong‚Äîyou'd get random movies instead of the most popular ones.

**What was happening:**

1. The MDBList API was returning items in the correct sorted order in the JSON response
2. But each item also has a `rank` field that represents its _original position in the list_, NOT its sorted position
3. We were incorrectly using `item.rank` instead of the array index
4. Also, for popularity metrics (where lower number = more popular), we were using the wrong sort direction

**The Fix:**

- Now correctly uses the **array position** as the sorted rank, ignoring the misleading `item.rank` field
- Automatically detects sort type and uses the correct order:
  - **Popularity sorts** (`imdbpopular`, `tmdbpopular`): Uses ascending order (rank #1 is more popular than #100)
  - **Rating sorts** (`imdbrating`, `rtomatoes`, `metacritic`, etc.): Uses descending order (10/10 is better than 1/10)

**Result:** Your Top Picks will now correctly match what you see on the MDBList website when sorted by the same option! üéØ

---

## üîî Auto-Dismiss Service Outage Alerts

**The Problem:** When an external API (MDBList, TMDb, OMDb, OpenAI) had a temporary outage (500/502/503/504 error), Aperture would show a "Service Unavailable" alert. But even after the service recovered, the alert would persist forever until you manually dismissed it.

**The Fix:** Outage alerts now **auto-dismiss** when a successful connection is detected:

- Testing your API connection in Settings will clear any stale outage alerts
- Only affects "outage" type errors (temporary server issues)
- Auth errors and rate limit warnings still require manual acknowledgment (since those need user action)

**What this means:** No more zombie alerts for services that are working fine! üëª

---

## Full Changelog

### Bug Fixes

- **Fix MDBList Top Picks sorting**: Use array position as sorted rank, not `item.rank` (which is original list position)
- **Fix sort order for popularity metrics**: Use ascending order for `imdbpopular`/`tmdbpopular` (lower = more popular)
- **Auto-dismiss outage errors**: Clear "Service Unavailable" alerts when connection test succeeds

### Technical

- Add `dismissOutageErrors()` function to clear outage-type errors by provider
- Update `testMDBListConnection`, `testTMDbConnection`, `testOMDbConnection`, `testOpenAIConnection` to auto-dismiss outage errors
- Add debug logging to show sorted vs original list positions in MDBList responses

---

If you've been frustrated with MDBList sorting not working correctly, this update should fix it! Let me know if you run into any issues. üçø
